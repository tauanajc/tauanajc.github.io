<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Tutorial 3 - Graphs &middot; Tauana Cunha</title>
        <meta name="description" content="Plots are important tools in data exploration, when you are first looking at your dataset and checking how data is distributed. It is also critical at a later stage, when you carefully design and customize figures to present your work in a talk or manuscript.
Today we will go over two sets of tools available for plotting in R: basic built-in functions, and a specific graphical package, ggplot2 (we will talk about packages in a minute).">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.69.0" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Tutorial 3 - Graphs">
<meta property="og:description" content="Plots are important tools in data exploration, when you are first looking at your dataset and checking how data is distributed. It is also critical at a later stage, when you carefully design and customize figures to present your work in a talk or manuscript.
Today we will go over two sets of tools available for plotting in R: basic built-in functions, and a specific graphical package, ggplot2 (we will talk about packages in a minute).">
<meta property="og:type" content="article">
<meta property="og:url" content="/courses/2020_stri_introR/tutorials/l3_graphs/">
        <link rel="stylesheet" href="/courses/2020_stri_introR/dist/site.css">
        <link rel="stylesheet" href="/courses/2020_stri_introR/dist/syntax.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        
        
        
        
    </head>
    <body>
        

        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="Tutorials" href="/courses/2020_stri_introR/">Tutorials</a>
                            </h1>
                        
                        <a class="button-square" href="/courses/2020_stri_introR/index.xml"><i class="fa fa-rss"></i></a>
                        
                        
                        
                        
                        
                        
                        
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="Home" href="/courses/2020_stri_introR/">Home</a>
    </li>

    <li class="site-nav-item">
        <a title="Schedule" href="/courses/2020_stri_introR/page/schedule/">Schedule</a>
    </li>

    <li class="site-nav-item">
        <a title="Resources" href="/courses/2020_stri_introR/page/resources/">Resources</a>
    </li>

    <li class="site-nav-item">
        <a title="" href=""></a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container">
        <header class="post-header">
    <h1 class="post-title">Tutorial 3 - Graphs</h1>
    
</header>

        <div class="post-content clearfix">
    

    


<p>Plots are important tools in data exploration, when you are first looking at your dataset and checking how data is distributed. It is also critical at a later stage, when you carefully design and customize figures to present your work in a talk or manuscript.</p>
<p>Today we will go over two sets of tools available for plotting in R: basic built-in functions, and a specific graphical package, <strong>ggplot2</strong> (we will talk about packages in a minute).</p>
<p>In <a href="https://www.r-graph-gallery.com">The R Graph Gallery</a>, you will find <a href="https://www.r-graph-gallery.com/all-graphs.html">beautiful plots</a> that can serve as inspiration and reference for your own work. Another option are these <a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">Top 50 ggplot2 Visualizations</a>.</p>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>First set your working directory:</p>
<pre class="r"><code>setwd(&quot;/Users/tauanajc/TEACHING/2020_STRI_introR/L3_Graphs&quot;) # Path to your project folder</code></pre>
</div>
<div id="packages" class="section level1">
<h1>Install and load packages</h1>
<p>R comes with many basic functions that we have already used. Many more functionalities are available through specific packages. These are sets of new R functions developed by the R community, accompanied by their own documentation (help pages). There are thousands of R packages that span a variety of purposes, for example to better manipulate data (<strong>dplyr</strong>), to plot phylogenetic trees (<strong>ggtree</strong>), to create websites (<strong>blogdown</strong>). Once you have installed a package, you can load it in your R session to make the new set of functions avalaible to you.</p>
<p>Let’s install the package that we will use later today, <strong>ggplot2</strong> (remember that the package name is case sensitive):</p>
<pre class="r"><code>install.packages(&quot;ggplot2&quot;) # Output omitted to keep the tutorial clean</code></pre>
<p>After installing it, the package is now in your computer and you can delete the installation command from your script. For all future projects, you only need to load your installed package at the top of the script:</p>
<pre class="r"><code>library(ggplot2)</code></pre>
<p>If a package has never been installed, you will get an error trying to load it:</p>
<pre class="r"><code>library(ggrepel)</code></pre>
<pre><code>## Error in library(ggrepel) : there is no package called ‘ggrepel’</code></pre>
</div>
<div id="import-and-manipulate-a-dataset" class="section level1">
<h1>Import and manipulate a dataset</h1>
<p>Let’s use the same dataset that Lee introduced in the previous class. Remember, this is an abbreviated dataset from <a href="https://esajournals.onlinelibrary.wiley.com/doi/abs/10.1002/eap.1573">Dietterich et al. 2017 Ecological Applications</a>. In brief, Lee collected leaves, roots, and soils from many individuals of five plant species growing throughout a site contaminated with the heavy metals zinc, lead and cadmium. He investigated the relationships between the metal concentrations in the soil, root colonization by mycorrhizal fungi (AMF), and metal concentrations in the leaves. AMF is shown as percent of root length colonized, and metal concentrations in leaves and soils are in mg/kg.</p>
<div id="read-data" class="section level2">
<h2>Read data</h2>
<pre class="r"><code>heavy_metals &lt;- read.csv(file = &quot;Dietterich et al 2017 data for R course.csv&quot;)</code></pre>
<p>Let’s look at the column names, the first few rows of this dataset and also its structure:</p>
<pre class="r"><code>colnames(heavy_metals)</code></pre>
<pre><code>## [1] &quot;Sample.id&quot; &quot;Species&quot;   &quot;AMF&quot;       &quot;Cd.leaf&quot;   &quot;Pb.leaf&quot;   &quot;Zn.leaf&quot;  
## [7] &quot;Cd.soil&quot;   &quot;Pb.soil&quot;   &quot;Zn.soil&quot;</code></pre>
<pre class="r"><code>head(heavy_metals)</code></pre>
<pre><code>##   Sample.id Species        AMF    Cd.leaf    Pb.leaf  Zn.leaf   Cd.soil
## 1     AA57A      AA 0.23157895  0.7783835   3.196124 123.6436        NA
## 2     AA57B      AA 0.13402062  6.5385033  11.485826 415.3090  28.79344
## 3     AA64A      AA 0.13483146  7.2124048  24.175478 283.9810        NA
## 4     AA64B      AA 0.18705036  8.7516034  85.286755 427.9493  36.38013
## 5     AA65A      AA 0.03370786 15.7864765  47.114983 899.6245 238.45015
## 6     AA65B      AA 0.04000000 29.9806136 227.177291 802.0886  88.95300
##      Pb.soil   Zn.soil
## 1   54.66782  987.7696
## 2  344.56057 2637.6816
## 3         NA        NA
## 4 1966.49775 3022.5225
## 5  931.60630 7681.7866
## 6 2997.54140 5212.4895</code></pre>
<pre class="r"><code>str(heavy_metals)</code></pre>
<pre><code>## &#39;data.frame&#39;:    124 obs. of  9 variables:
##  $ Sample.id: chr  &quot;AA57A&quot; &quot;AA57B&quot; &quot;AA64A&quot; &quot;AA64B&quot; ...
##  $ Species  : chr  &quot;AA&quot; &quot;AA&quot; &quot;AA&quot; &quot;AA&quot; ...
##  $ AMF      : num  0.2316 0.134 0.1348 0.1871 0.0337 ...
##  $ Cd.leaf  : num  0.778 6.539 7.212 8.752 15.786 ...
##  $ Pb.leaf  : num  3.2 11.5 24.2 85.3 47.1 ...
##  $ Zn.leaf  : num  124 415 284 428 900 ...
##  $ Cd.soil  : num  NA 28.8 NA 36.4 238.5 ...
##  $ Pb.soil  : num  54.7 344.6 NA 1966.5 931.6 ...
##  $ Zn.soil  : num  988 2638 NA 3023 7682 ...</code></pre>
</div>
<div id="change-labels-and-codes" class="section level2">
<h2>Change labels and codes</h2>
<p>To make things more clear for us, let’s change the column names:</p>
<pre class="r"><code>colnames(heavy_metals) &lt;- c(&quot;SampleID&quot;, &quot;Species&quot;, &quot;Mycorrhizal_Colonization&quot;,
                            &quot;Leaves_Cadmium&quot;, &quot;Leaves_Zinc&quot;, &quot;Leaves_Lead&quot;,
                            &quot;Soil_Cadmium&quot;, &quot;Soil_Lead&quot;, &quot;Soil_Zinc&quot;)</code></pre>
<p>Check how they are now:</p>
<pre class="r"><code>colnames(heavy_metals)</code></pre>
<pre><code>## [1] &quot;SampleID&quot;                 &quot;Species&quot;                 
## [3] &quot;Mycorrhizal_Colonization&quot; &quot;Leaves_Cadmium&quot;          
## [5] &quot;Leaves_Zinc&quot;              &quot;Leaves_Lead&quot;             
## [7] &quot;Soil_Cadmium&quot;             &quot;Soil_Lead&quot;               
## [9] &quot;Soil_Zinc&quot;</code></pre>
<p>Let’s also change the species codes, replacing them with the genus name:</p>
<pre class="r"><code># Create a vector with the genus names
genera &lt;- c(&quot;Ageratina&quot;, &quot;Deschampsia&quot;, &quot;Eupatorium&quot;, &quot;Minuartia&quot;, &quot;Agrostis&quot;)
# Name the elements of this vector according to their code
names(genera) &lt;- c(&quot;AA&quot;, &quot;DF&quot;, &quot;ES&quot;, &quot;MP&quot;, &quot;AP&quot;)
genera</code></pre>
<pre><code>##            AA            DF            ES            MP            AP 
##   &quot;Ageratina&quot; &quot;Deschampsia&quot;  &quot;Eupatorium&quot;   &quot;Minuartia&quot;    &quot;Agrostis&quot;</code></pre>
<pre class="r"><code># Let&#39;s try indexing the new genera object
genera[c(&quot;AA&quot;, &quot;AA&quot;, &quot;AA&quot;)] # We get 3 times the full genus name of code AA</code></pre>
<pre><code>##          AA          AA          AA 
## &quot;Ageratina&quot; &quot;Ageratina&quot; &quot;Ageratina&quot;</code></pre>
<pre class="r"><code># Now let&#39;s give it the entire column of species
genera[heavy_metals$Species] # We get a new vector of all the genera names according to the code!</code></pre>
<pre><code>##            AA            AA            AA            AA            AA 
##   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot; 
##            AA            AA            AA            AA            AA 
##   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot; 
##            AA            AA            AA            AA            AA 
##   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot; 
##            AA            AA            AA            AA            AA 
##   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot; 
##            AA            AA            AA            DF            DF 
##   &quot;Ageratina&quot;   &quot;Ageratina&quot;   &quot;Ageratina&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; 
##            DF            DF            DF            DF            DF 
## &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; 
##            DF            DF            DF            DF            DF 
## &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; 
##            DF            DF            DF            DF            DF 
## &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; &quot;Deschampsia&quot; 
##            DF            ES            ES            ES            ES 
## &quot;Deschampsia&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot; 
##            ES            ES            ES            ES            ES 
##  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot; 
##            ES            ES            ES            ES            ES 
##  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot; 
##            ES            ES            ES            ES            ES 
##  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;  &quot;Eupatorium&quot; 
##            ES            ES            MP            MP            MP 
##  &quot;Eupatorium&quot;  &quot;Eupatorium&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot; 
##            MP            MP            MP            MP            MP 
##   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot; 
##            MP            MP            MP            MP            MP 
##   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot; 
##            MP            MP            MP            MP            MP 
##   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot; 
##            MP            MP            MP            MP            MP 
##   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot;   &quot;Minuartia&quot; 
##            MP            AP            AP            AP            AP 
##   &quot;Minuartia&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot; 
##            AP            AP            AP            AP            AP 
##    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot; 
##            AP            AP            AP            AP            AP 
##    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot; 
##            AP            AP            AP            AP            AP 
##    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot; 
##            AP            AP            AP            AP            AP 
##    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot; 
##            AP            AP            AP            AP            AP 
##    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot; 
##            AP            AP            AP            AP            AP 
##    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot; 
##            AP            AP            AP            AP 
##    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;    &quot;Agrostis&quot;</code></pre>
<pre class="r"><code># Use the command above to overwrite the content of the column Species
heavy_metals$Species &lt;- genera[heavy_metals$Species]</code></pre>
<p>Check that this worked by looking at some random lines of the dataset. Use indexing to select just a few lines, and the first 5 columns:</p>
<pre class="r"><code>heavy_metals[c(1,30,50,75,90), 1:5]</code></pre>
<pre><code>##    SampleID     Species Mycorrhizal_Colonization Leaves_Cadmium Leaves_Zinc
## 1     AA57A   Ageratina                0.2315789      0.7783835    3.196124
## 30    DF57A Deschampsia                       NA      4.1212228   25.720846
## 50     H72B  Eupatorium                0.1200000     67.3486260  119.868176
## 75   MP121x   Minuartia                0.0000000     78.6864724    8.927673
## 90     Y57B    Agrostis                0.0250000      9.8749091   12.273389</code></pre>
<p>Before plotting, let’s also change the Species column from character to factor:</p>
<pre class="r"><code>heavy_metals$Species &lt;- as.factor(heavy_metals$Species)
str(heavy_metals)</code></pre>
<pre><code>## &#39;data.frame&#39;:    124 obs. of  9 variables:
##  $ SampleID                : chr  &quot;AA57A&quot; &quot;AA57B&quot; &quot;AA64A&quot; &quot;AA64B&quot; ...
##  $ Species                 : Factor w/ 5 levels &quot;Ageratina&quot;,&quot;Agrostis&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Mycorrhizal_Colonization: num  0.2316 0.134 0.1348 0.1871 0.0337 ...
##  $ Leaves_Cadmium          : num  0.778 6.539 7.212 8.752 15.786 ...
##  $ Leaves_Zinc             : num  3.2 11.5 24.2 85.3 47.1 ...
##  $ Leaves_Lead             : num  124 415 284 428 900 ...
##  $ Soil_Cadmium            : num  NA 28.8 NA 36.4 238.5 ...
##  $ Soil_Lead               : num  54.7 344.6 NA 1966.5 931.6 ...
##  $ Soil_Zinc               : num  988 2638 NA 3023 7682 ...</code></pre>
<p>Finally, let’s plot some graphs!</p>
</div>
</div>
<div id="basic-plots-with-built-in-functions" class="section level1">
<h1>Basic plots with built-in functions</h1>
<p>First we will go over some of the most common plot types with built-in functions in R.</p>
<div id="histogram" class="section level2">
<h2>Histogram</h2>
<p>This is a very standard type of plot, in which you can see the frequencies of values in your data. It automatically bins the data in ranges, but you can also customize the number of bins. To plot a histogram with base R we use the <strong>hist</strong> command.</p>
<p>Let’s look at the distribution of the zinc concentrations in the leaves of all plant species:</p>
<pre class="r"><code>hist(heavy_metals$Leaves_Zinc)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>With more bins, we can better see the distribution of zinc concentrations, take a look below.</p>
<p>And you probably noticed that the names of the axis look terrible! You should always change them to informative names. Same goes for the title. Any of those can also be left blank.</p>
<pre class="r"><code>hist(heavy_metals$Leaves_Zinc, breaks = 20, # Specify number of bins
     main = &quot;&quot;, # Plot title
     xlab = &quot;Zinc concentration in plant leaves (mg/kg)&quot;, # Axes labels
     ylab = &quot;Frequency&quot;)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Much better! Remember to use the help function whenever you want to see the other arguments and options for any command:</p>
<pre class="r"><code>help(hist)
?hist</code></pre>
</div>
<div id="boxplot" class="section level2">
<h2>Boxplot</h2>
<p>The boxplot summarizes the data, without having all data points in the graph. The lines of the box correspond to the median, quartiles, minimum and maximum values of the dataset. The spacing between the parts of the box reflect the amount of spread and skewness in the data. If present, outliers are usually plotted as dots/circles. The command here is easy to remember: <strong>boxplot</strong>.</p>
<p>Let’s get a boxplot for the exact same zinc concentrations that we used in the histogram:</p>
<pre class="r"><code>boxplot(heavy_metals$Leaves_Zinc,
        ylab = &quot;Zinc concentration in leaves (mg/kg)&quot;)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>A bit more information on how to interpret boxplots:</p>
<ul>
<li>median: middle value of the ordered set, such that 50% of the values are smaller than the median and 50% are greater</li>
<li>first quartile (Q1): value below which are 25% of the elements of the ordered set</li>
<li>third quartile (Q2): value below which are 75% of the elements of the ordered set = above which are 25% of the elements</li>
<li>maximum: largest number of the set (excluding outliers)</li>
<li>minimum: smallest number of the set (excluding outliers)</li>
<li>outliers: if present, these are values that are below Q1 or above Q3 by at least 1.5 times the interval between these two quartiles (interquantile range)</li>
</ul>
<p>It would be more interesting to look at the distribution of zinc concentrations for each one of the individual plant species. The boxplot allows you to plot a separate box for each level of a factor:</p>
<pre class="r"><code>boxplot(formula = Leaves_Zinc ~ Species, data = heavy_metals,
        ylab = &quot;Zinc concentration in leaves (mg/kg)&quot;,
        xlab = &quot;&quot;)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="scatter-plot" class="section level2">
<h2>Scatter plot</h2>
<p>Scatter plots are used to visualize the relationship between two variables. The command is simply <strong>plot</strong>.</p>
<p>Let’s try a scatter plot with our soil and leaf concentrations of lead:</p>
<pre class="r"><code>plot(formula = Leaves_Lead ~ Soil_Lead, data = heavy_metals,
     ylab = &quot;Lead concentration in leaves (mg/kg)&quot;,
     xlab = &quot;Lead concentration in soil (mg/kg)&quot;)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>There seems to be a positive relationship betwen soil and leaf concentrations of lead. What if we look at individual plant species? Let’s use a <strong>for loop</strong> to get a scatter plot for each of the plants:</p>
<pre class="r"><code>for(i in 1:5){ # 5 species of plant
  each_plant = subset(heavy_metals, Species == levels(heavy_metals$Species)[i]) # subset for each species
  plot(formula = Leaves_Lead ~ Soil_Lead, data = each_plant, # plot variables
       main = levels(heavy_metals$Species)[i], # title indexed to get species name
       ylab = &quot;Lead concentration in leaves (mg/kg)&quot;,
       xlab = &quot;Lead concentration in soil (mg/kg)&quot;)}</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-19-1.png" width="672" /><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-19-2.png" width="672" /><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-19-3.png" width="672" /><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-19-4.png" width="672" /><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-19-5.png" width="672" /></p>
<p>With that we see that each plant species has a somewhat different relationship between soil and leaf concentrations of metal. <strong>Remember that this is a small sample dataset, and not the complete dataset from Lee’s paper, so our plots are merely illustrative and do not necessarily reflect real results.</strong></p>
</div>
<div id="customization-with-base-r" class="section level2">
<h2>Customization with base R</h2>
<p>There are many other types of plots available in base R, and many more options for customization, for example colors, margins and panels with multiple plots. Below is one panel example with multiple plots and customizations. Use the help function to explore each command that is not yet familiar to you.</p>
<p>For more examples and details on customization of base R graphs, check the help page of the command <strong>par</strong> and also <a href="https://rstudio-pubs-static.s3.amazonaws.com/84527_6b8334fd3d9348579681b24d156e7e9d.html">this</a> and <a href="https://flowingdata.com/2012/12/17/getting-started-with-charts-in-r/">this</a> websites as starting points. Help pages and google are your best friends to customize R plots.</p>
<pre class="r"><code># output omitted to keep tutorial clean
colors() # existing colors in base R
?points # symbols</code></pre>
<pre class="r"><code>palette.pals() # several new palettes added as of R v4.0.0</code></pre>
<pre><code>##  [1] &quot;R3&quot;              &quot;R4&quot;              &quot;ggplot2&quot;         &quot;Okabe-Ito&quot;      
##  [5] &quot;Accent&quot;          &quot;Dark 2&quot;          &quot;Paired&quot;          &quot;Pastel 1&quot;       
##  [9] &quot;Pastel 2&quot;        &quot;Set 1&quot;           &quot;Set 2&quot;           &quot;Set 3&quot;          
## [13] &quot;Tableau 10&quot;      &quot;Classic Tableau&quot; &quot;Polychrome 36&quot;   &quot;Alphabet&quot;</code></pre>
<p>Other objects needed to create a barplot that will be used below:</p>
<pre class="r"><code># data frame for the colors you want for each species
plant_colors &lt;- data.frame(Species = factor(levels(heavy_metals$Species)),
                           Color = c(&quot;darkgreen&quot;, &quot;darkorange&quot;,
                                     &quot;deepskyblue&quot;, &quot;firebrick&quot;, &quot;darkviolet&quot;),
                           Symbol = c(7,19,24,0,8))
plant_colors</code></pre>
<pre><code>##       Species       Color Symbol
## 1   Ageratina   darkgreen      7
## 2    Agrostis  darkorange     19
## 3 Deschampsia deepskyblue     24
## 4  Eupatorium   firebrick      0
## 5   Minuartia  darkviolet      8</code></pre>
<pre class="r"><code># Creating a function to calculate the standard error - same as last week
se &lt;- function(x) {
  sd(x)/sqrt(length(x))}</code></pre>
<pre class="r"><code># Calculate mean and standard error of zinc concentrations for each species
for_barplot &lt;- with(data = heavy_metals,
                    aggregate(formula = Leaves_Zinc ~ Species, FUN = mean))

colnames(for_barplot) &lt;- c(&quot;Species&quot;, &quot;Mean_Zinc&quot;)

for_barplot$SE_Zinc &lt;- with(data = heavy_metals,
                            aggregate(formula = Leaves_Zinc ~ Species, FUN = se))[,2]

for_barplot</code></pre>
<pre><code>##       Species Mean_Zinc    SE_Zinc
## 1   Ageratina 62.883543 11.8650922
## 2    Agrostis 23.731515  2.5032906
## 3 Deschampsia 10.794596  1.8038057
## 4  Eupatorium 41.123450  5.9537711
## 5   Minuartia  7.612877  0.5639889</code></pre>
<div id="multiple-customized-plots" class="section level3">
<h3>Multiple customized plots</h3>
<pre class="r"><code>#pdf(file = &quot;baseRpanel.pdf&quot;, width = 8, height = 8) # Explained below

# par = graphical parameters 
par(mfrow = c(2,2)) # mfrow: panel of 2x2 plots, ordered by row

# Histogram
hist(heavy_metals$Soil_Zinc, breaks = 20,
     main = &quot;&quot;,
     xlab = &quot;Zinc concentration in soil (mg/kg)&quot;)

# Boxplot
boxplot(formula = Leaves_Zinc ~ Species, data = heavy_metals,
        col = plant_colors$Color,
        xaxt = &quot;n&quot;, # Suppress the x axis completely
        ylab = &quot;Zinc concentration in leaves (mg/kg)&quot;,
        xlab = &quot;&quot;,
        main = &quot;Boxplots are better than barplots:&quot;)

text(x = 1:5, y = -23, # Position to add labels in x axis
     labels = for_barplot$Species, # Text to add
     xpd = TRUE, # Enable text outside the plot region
     srt = 15) # Angle

mtext(text = &quot;GOOD INFO/INK RATIO&quot;,
      side = 3, # Side of graph
      col = &quot;firebrick&quot;,
      cex = .8) # Size of text

# Scatter plot
plot(formula = Mycorrhizal_Colonization*100 ~ Soil_Zinc,
     data = heavy_metals,
     col = palette.colors(n = 5, &quot;Dark 2&quot;),
     pch = plant_colors$Symbol,
     ylab = &quot;Root colonization by fungi (%)&quot;,
     xlab = &quot;Zinc concentration in soil (mg/kg)&quot;)

mtext(text = &quot;Different color palette just to illustrate&quot;,
      side = 4,
      col = &quot;firebrick&quot;,
      cex = .8)

## text() - adds text to plot
## mtext() - adds text into one of the four margins of the plot

# Barplot
barplot(formula = Mean_Zinc ~ Species,
        data = for_barplot,
        col = plant_colors$Color,
        xaxt = &quot;n&quot;,
        ylab = &quot;Zinc concentration in leaves (mg/kg)&quot;,
        xlab = &quot;&quot;,
        ylim = c(0,80))

text(x = c(0.7,1.9,3.1,4.3,5.5),
     y = -5,
     labels = for_barplot$Species,
     xpd=TRUE,
     srt=15)

arrows(y0 = for_barplot$Mean_Zinc-for_barplot$SE_Zinc,
       y1 = for_barplot$Mean_Zinc+for_barplot$SE_Zinc,
       x0 = c(0.7,1.9,3.1,4.3,5.5),
       x1 = c(0.7,1.9,3.1,4.3,5.5),
       angle=90,
       code=3,
       length = 0.1)

mtext(text = &quot;BAD INFO/INK RATIO&quot;,
      side = 3,
      col = &quot;firebrick&quot;,
      cex = .8)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-25-1.png" width="768" /></p>
<pre class="r"><code>par(mfrow = c(1,1)) # Set graphic device back to 1 plot only

#dev.off() # Explained below</code></pre>
</div>
</div>
<div id="save-basic-plots-to-file" class="section level2">
<h2>Save basic plots to file</h2>
<p>Basic graphs can be saved with functions like <strong>pdf</strong>, <strong>png</strong>, <strong>tiff</strong> or <strong>jpeg</strong>, which open an external graphics device to save your figure. The graph will not show on your RStudio window, but it will be automatically saved in your working directory. After the <strong>pdf</strong> command, you list your plotting commands, followed by closing the device with <strong>dev.off</strong>:</p>
<pre class="r"><code>pdf(file = &quot;baseRhist.pdf&quot;, width = 5, height = 5) # Open device

hist(heavy_metals$Soil_Zinc, breaks = 20,
     main = &quot;Zinc concentrations (mg/kg)&quot;, xlab= &quot;Soil&quot;)

dev.off() # Close device</code></pre>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<p>The above was a short example with a simple graph. Now use the <strong>pdf</strong> and <strong>dev.off</strong> commands on the 4-plot panel above.</p>
</div>
</div>
<div id="ggplot2" class="section level1">
<h1>ggplot2</h1>
<p>Although the R built-in functions can be sufficient for many purposes, there are several graphical packages that allow more flexibility and simplicity when plotting elaborate graphs. <strong>ggplot2</strong> is arguably the most used R tool for creating graphs nowadays.</p>
<p>One major difference in the usage of <strong>ggplot2</strong> is the syntax. The system for adding plot elements is based on building blocks, layers that you put together to create and edit any graph. Compared to base graphics, <strong>ggplot2</strong> can be more verbose for simple graphics, but much less verbose for complex graphics. The data should always be in a data frame. The basic structure is: <code>ggplot(dataset) + geom_() + theme()</code></p>
<p>where the first part calls an empty plot with the specified dataset, then each layer for customization is added with a <strong>+</strong> sign. There are many <strong>geom_</strong> functions available, as we will see below.</p>
<p>You can find information on all <strong>ggplot2</strong> commands in this <a href="https://ggplot2.tidyverse.org/reference/index.html">Reference</a> page, and a <a href="https://ggplot2.tidyverse.org">cheatsheet</a> for the most used functions.</p>
<p>With the package loaded, you can also call help for the new functions that came with <strong>ggplot2</strong>:</p>
<pre class="r"><code>?ggplot</code></pre>
<p>Let’s try all the same types of graph that we built with base R.</p>
<div id="histogram-1" class="section level2">
<h2>Histogram</h2>
<p>Step by step, let’s see what the parts do:</p>
<pre class="r"><code>ggplot(heavy_metals) # Just an empty plot, but holds the data to be used</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Now we specify the set of aesthetics that will be used throughout the following layers (the information is said to be <em>inherited</em> by the next commands). Aesthetic (aes) are mappings of a visual element to a specific variable, for example: the position of the data (on the x and y axes), a color pattern that follows the factor levels of another variable.</p>
<pre class="r"><code>ggplot(heavy_metals, aes(x = Leaves_Zinc)) + # Dataset and variable specified to the x axis
  geom_histogram(bins = 20, na.rm = TRUE) # Specify histogram type of plot</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div id="default-themes" class="section level3">
<h3>Default themes</h3>
<p>The <strong>theme_</strong> command has several default, nice-looking themes to change background colors and patterns. Also use the function <strong>labs</strong> to change the names of the axes:</p>
<pre class="r"><code>gghist &lt;- ggplot(heavy_metals, aes(x = Leaves_Zinc)) +
  geom_histogram(bins = 20, na.rm = TRUE) +
  theme_minimal() + # Various default themes
  labs(x = &quot;Zinc concentration in plant leaves (mg/kg)&quot;, y = &quot;Frequency&quot;) # Titles

gghist</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
</div>
<div id="boxplot-1" class="section level2">
<h2>Boxplot</h2>
<p>Here we add the y aesthetics, so that we can specify both the zinc concentration and the species as variables. You can also add aesthetics not on the ggplot command, but on the <strong>geom_</strong> function of the specific type of plot, in which case the aesthetics are not inherited by other layers. For this particular boxplot, not inheriting the data does not matter, because none of the following layers need the data itself.</p>
<pre class="r"><code>ggplot(heavy_metals) +
  geom_boxplot(aes(y = Leaves_Zinc, x = Species), na.rm = TRUE) + # boxplot with variables in aesthetics
  theme_minimal() +
  labs(x = &quot;&quot;, y = &quot;Zinc concentration in plant leaves (mg/kg)&quot;)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div id="mapping-color-aesthetics" class="section level3">
<h3>Mapping color aesthetics</h3>
<p>Add color to the border and fillings of the boxes according to a variable (in this case, the Species):</p>
<pre class="r"><code>ggplot(heavy_metals) +
  geom_boxplot(aes(y = Leaves_Zinc, x = Species,
                   col = Species, fill = Species), na.rm = TRUE) + # new color aesthetics
  theme_minimal() +
  labs(x = &quot;&quot;, y = &quot;Zinc concentration in plant leaves (mg/kg)&quot;)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>But the fill hides the value of the median. We can make the fill color transparent in the <strong>geom_</strong> function (fixed visual attributes are set outside of <strong>aes</strong>). We can also change color schemes with <strong>scale_</strong> functions:</p>
<pre class="r"><code>ggplot(heavy_metals) +
  geom_boxplot(aes(y = Leaves_Zinc, x = Species,
                   col = Species, fill = Species),
               na.rm = TRUE,
               alpha = 0.3) + # Transparency
  theme_minimal() +
  labs(x = &quot;&quot;, y = &quot;Zinc concentration in plant leaves (mg/kg)&quot;) +
  scale_fill_brewer(palette = &quot;Dark2&quot;) + # Color palette for the fill
  scale_color_brewer(palette = &quot;Dark2&quot;) # and for the borders</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="color-brewer" class="section level3">
<h3>Color Brewer</h3>
<p>The website <a href="http://colorbrewer2.org">Color Brewer</a> is great for finding palettes for different types of data (e.g. discrete, continuous), including options that are color-blind safe. You can pick colors manually or get the names of the palettes to use in the <strong>scale_</strong> functions.</p>
<p>Also check the help to find palettes names without going to the website:</p>
<pre class="r"><code>?scale_color_brewer</code></pre>
</div>
<div id="theme-elements" class="section level3">
<h3>Theme elements</h3>
<p>The <strong>theme</strong> function allows you to edit all kinds of elements of the plot that are not the data itself, such as</p>
<ul>
<li>legends</li>
<li>fonts of axis</li>
<li>titles</li>
<li>background</li>
</ul>
<p>In this graph, we don’t need the legend, so we can remove it. It would also be nice to italicize the names of the genera, and make them fit better to the graph by setting the words at an angle.</p>
<pre class="r"><code>ggbox &lt;- ggplot(heavy_metals) +
  geom_boxplot(aes(y = Leaves_Zinc, x = Species,
                   col = Species, fill = Species),
               na.rm = TRUE,
               alpha = 0.6) +
  theme_minimal() +
  labs(x = &quot;&quot;, y = &quot;Zinc concentration in plant leaves (mg/kg)&quot;) +
  scale_fill_brewer(palette = &quot;Dark2&quot;) +
  scale_color_brewer(palette = &quot;Dark2&quot;) +
  theme(legend.position = &quot;none&quot;, # Remove legend
        axis.text.x = element_text(face = &quot;italic&quot;, # Make names italic
                                   size = 12, # Increase font size for x labels
                                   angle = 15)) # Angle of x labels

ggbox</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
</div>
<div id="scatter-plot-1" class="section level2">
<h2>Scatter plot</h2>
<p>Below we recreate the scatter plot of how lead concentration of leaves relates to concentration in the soil. With base R, we used a <strong>for loop</strong> to create one plot per species. Let’s use the aesthetics of <strong>ggplot2</strong> to differentiate the points of each Species by color, in the same plot. We are also going to label specific points of interest with <strong>geom_text</strong>, and explore more arguments of the <strong>theme</strong> function:</p>
<pre class="r"><code>ggpoint &lt;- ggplot(heavy_metals, aes(x = Soil_Lead, y = Leaves_Lead)) +
  geom_point(aes(col = Species, fill = Species), # aestethics for geom_points
             na.rm = TRUE, pch = 22, size = 3) + # attributes for points
  theme_minimal() +
  theme(axis.title = element_text(size = 11),
        legend.text = element_text(face = &quot;italic&quot;, size = 11), # Italics in the legend
        #legend.position = &quot;top&quot;, # Position of legend
        legend.position = &quot;none&quot;, # Position of legend
        legend.title = element_blank()) + # Remove title of legend
  scale_fill_brewer(palette = &quot;Dark2&quot;) +
  scale_color_brewer(palette = &quot;Dark2&quot;) +
  geom_text(aes(label = SampleID), data = subset(heavy_metals, Leaves_Lead &gt; 10000)) + # Label subset of points
  labs(x = &quot;Lead concentration in soil (mg/kg)&quot;,
       y = &quot;Lead concentration in leaves (mg/kg)&quot;)

ggpoint</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div id="ggrepel-and-geom_jitter" class="section level3">
<h3>ggrepel and geom_jitter</h3>
<p>In the graph above, the labels are on top of our data points, which does not look very nice. For how to move the labels away from the points, check out the package <strong>ggrepel</strong> and its function <strong>geom_text_repel</strong>. You do not need to do this now, just keep this information as a reference for the future.</p>
<p>In other plots where points themselves overlap, you might also want to force a tiny distance between them to improve visualization. <strong>ggplot2</strong> can do that with <strong>geom_jitter</strong>, which adds a small random variation to the actual position of your data. Look it up whenever you need it.</p>
</div>
</div>
<div id="barplot" class="section level2">
<h2>Barplot</h2>
<p>We already saw how barplots are little informative compared to other types of plots, but for the sake of the comparison with base R, let’s create a barplot with <strong>ggplot2</strong> as well.</p>
<pre class="r"><code>ggbar &lt;- ggplot(heavy_metals, aes(y = Leaves_Zinc, x = Species,
                         col = Species, fill = Species)) +
  geom_bar(stat = &quot;summary&quot;, fun = &quot;mean&quot;, na.rm = TRUE) + # Barplot with mean as summary statistics
  stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;, na.rm = TRUE, # Add SE bars
               width = .5, col = &quot;black&quot;) +
  theme_minimal() +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(size = 12, face = &quot;italic&quot;, angle = 15),
        legend.text = element_text(face = &quot;italic&quot;, size = 12),
        legend.position = &quot;none&quot;) +
  scale_color_brewer(palette = &quot;Dark2&quot;) + 
  scale_fill_brewer(palette = &quot;Dark2&quot;) +
  labs(x = &quot;&quot;, y = &quot;Zinc concentration in leaves (mg/kg)&quot;)

ggbar</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="assign-ggplots-to-objects" class="section level2">
<h2>Assign ggplots to objects</h2>
<p>Plots made with <strong>ggplot2</strong> can be assigned to new objects, which you can use as a shortcut to keep editting the plot:</p>
<pre class="r"><code>zinc_box &lt;- ggplot(heavy_metals) +
  geom_boxplot(aes(y = Leaves_Zinc, x = Species), na.rm = TRUE)</code></pre>
<pre class="r"><code>zinc_box</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre class="r"><code>zinc_box +
  theme_minimal() +
  labs(x = &quot;&quot;, y = &quot;Zinc concentration in plant leaves (mg/kg)&quot;)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="facet-plots" class="section level2">
<h2>Facet plots</h2>
<p><strong>ggplot2</strong> uses facets to easily display several plots of the same kind, each representing a specific level of a categorical variable. Let’s take the zinc data we used in the scatter plot and produce one plot per Species, all in the same figure:</p>
<pre class="r"><code>ggplot(heavy_metals) +
  geom_point(aes(x = Soil_Lead, y = Leaves_Lead, fill = Species),
             na.rm = TRUE, pch = 22, size = 3) +
  theme_minimal() +
  facet_wrap(~ Species, nrow = 3) + # Wrap plots by Species
  theme(axis.title = element_text(size = 12),
        legend.position = &quot;none&quot;,
        strip.text = element_text(size = 12, face = &quot;italic&quot;)) +
  scale_fill_brewer(palette = &quot;Dark2&quot;) +
  labs(x = &quot;Lead concentration in leaves (mg/kg)&quot;,
       y = &quot;Lead concentration in soil (mg/kg)&quot;)</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-41-1.png" width="480" /></p>
</div>
<div id="grid-of-independent-plots" class="section level2">
<h2>Grid of independent plots</h2>
<p>The easiest way to combine multiple plots on a page is the <strong>plot_grid</strong> function from the package <strong>cowplot</strong>. For more detail and many more elaborate options, check this <a href="https://wilkelab.org/cowplot/articles/plot_grid.html">website</a>.</p>
<p>First, go back to the four plots we produced with <strong>ggplot2</strong> and assign them to object names - use gghist, ggbox, ggpoint, ggbar for the names.</p>
<p><strong>As an exercise, practice installing and loading a new package:</strong>
(Hint: go back to the <a href="#packages">section on packages</a> of the tutorial)</p>
<pre class="r"><code># GIVE IT A TRY:</code></pre>
<p>Now that you have new functions from <strong>cowplot</strong> available, let’s combine all plots into one panel:</p>
<pre class="r"><code>metal_plots &lt;- plot_grid(gghist, ggbox, ggpoint, ggbar,
          nrow = 2, # Plots distributed in two rows
          align = &quot;h&quot;, # Align plots horizontally
          axis = &quot;l&quot;, # Side on which to align
          labels = &quot;AUTO&quot;, # Place autmatic labels on each plot
          scale = 0.88) # Scale down the size of plots to increase white space in between

metal_plots</code></pre>
<p><img src="/courses/2020_stri_introR/tutorials/L3_Graphs_files/figure-html/unnamed-chunk-44-1.png" width="768" /></p>
</div>
<div id="save-ggplots-to-file" class="section level2">
<h2>Save ggplots to file</h2>
<p>To save a plot to a file in your computer, use the function <strong>ggsave</strong> and the name of your plot object:</p>
<pre class="r"><code>ggsave(filename = &quot;ggplot2panel.pdf&quot;, plot = metal_plots,
       device = &quot;pdf&quot;, width = 8, height = 8, units = &quot;in&quot;)</code></pre>
</div>
</div>
<div id="exercises" class="section level1">
<h1>Exercises!</h1>
<p>Practice your skills with plotting on another dataset. If you have your own data, get going with your work! Otherwise, use this cool dataset about <a href="https://github.com/tacookson/data/tree/master/himalayan-expeditions">Himalayan Climbing Expeditions</a>. The <strong>members.csv</strong> file is available to you in the zipped class material in the <a href="http://tauanajc.github.io/courses/2020_stri_introR/page/schedule">Schedule</a> page of the website.</p>
<p>Start with reading the dataset into R, and looking at which variables are present.</p>
<pre class="r"><code># IMPORT AND EXPLORE YOUR DATA</code></pre>
<ol style="list-style-type: decimal">
<li>Plot two distinct types of graph (it’s ok to try out other types that we did not see together!). Feel free to use built-in functions or ggplot2. The dataset has many interesting variables, many possible questions to explore. There is no correct answer, you can pick and choose basically anything you like. The only rule is that you have to change, in one or both of the graphs, at least the following:</li>
</ol>
<ul>
<li>axes titles</li>
<li>any font element in any part of the plot</li>
<li>color scheme</li>
<li>some element of the legend</li>
</ul>
<pre class="r"><code># PLOT 1</code></pre>
<pre class="r"><code># PLOT 2</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Now combine these two (or more) plots into one figure:</li>
</ol>
<pre class="r"><code># PANEL WITH MULTIPLE PLOTS</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Save your plot(s)</li>
</ol>
<pre class="r"><code># SAVE</code></pre>
</div>

</div>

        <footer class="post-footer clearfix">
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?text=Tutorial%203%20-%20Graphs&url=%2fcourses%2f2020_stri_introR%2ftutorials%2fl3_graphs%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
        

        
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=%2fcourses%2f2020_stri_introR%2ftutorials%2fl3_graphs%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
            </a>
        

        
        
    </div>
</footer>
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="Tutorials" href="/courses/2020_stri_introR/">Tutorials</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2020 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="/courses/2020_stri_introR/js/jquery-1.11.3.min.js"></script>
        <script src="/courses/2020_stri_introR/js/jquery.fitvids.js"></script>
        <script src="/courses/2020_stri_introR/js/scripts.js"></script>
    </body>
</html>

